\documentclass[letterpaper,nofootinbib,prd,amsmath,onecolumn]{revtex4-1}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{float}
\usepackage{listings}
\usepackage{pdfpages}
\usepackage{courier}
\usepackage{color}
\usepackage{mathrsfs}

\begin{document}
\special{papersize=8.5in,11in}

\title{Invariant Gauge Conditions under Foliation Preserving Coordinate Transformation}
\author{J.~David Brown, Meng Cao}
\affiliation{Department of Physics, North Carolina State University, Raleigh, NC 27695 USA}

\begin{abstract}
The transform law of 3 + 1 splitting variables, such as the lapse, shift vector, extrinsic curvature and etc., under a foliation preserving coordinate transformation are presented. The covariant forms of time derivative of the lapse and time derivative of the shift vector are given. The invariant form of 1 + log slicing condition and Gamma-driver shift equation are derived from those covariant time derivatives. Utilize these invariant gauge conditions, it allows one to evolve the same system with two different coordinate systems and reach the same result. A time dependent spatial rotation coordinate transformation is discussed in details as a specific example of this case.  
\end{abstract}
\maketitle

\section{Introduction}
The Einstein's equations are in the covariant form under spacetime diffeomorphism, which means the equations are invariant under spacetime coordinate transformations. 3 + 1 splitting mechanism slices the spacetime into a family of spacelike hypersurfaces which is referred as foliations. On each foliation, a timelike parameter t is constant. By breaking the symmetry of time and space domain, the 3 + 1 formulation makes it possible to evolve a general relativity system along with time numerically. On the other hand, although it still preserves the invariant property, it is not manifest in the equations anymore. While constructing numerical simulations, either in ADM formulation or BSSN formulation, people use gauge conditions(such as 1 + log slicing and Gamma-driver shift condition) to evolve the lapse and shift vector along with time. Unfortunately, these gauge condition equations are neither explicitly nor implicitly covariant. This scheme works sufficiently accurate if the system is evolved in one single coordinate system. However, if the same system is evolved with two different coordinate systems to the same time under this kind of gauge conditions, it is not guaranteed that we can get the same results. 

This situation leads to our motivation of this paper. We will try to examine the transform pattern of physical quantities in 3 + 1 splitting system under a so called ``foliation preserving coordinate transformation'', which includes time reparamerization and time dependent spatial deffeomorphism while the structure of foliations is preserved. Then we will try to write down the covariant form of the gauge conditions under this coordinate transformation and give the guideline of how to implement this into numerical simulation. 

The paper is organized as follows. In Sec.~\ref{3+1}, we explain the notation and convention we are going to follow in this paper. Then we briefly review the 3 + 1 splitting formulation while introducing several significant terms which will be used in latter sections. In Sec.~\ref{transform}, we give the definition of foliation preserving coordinate transformation, under which we derive and list the transform pattern of all significant 3 + 1 splitting physical quantities. The ordinary gauge conditions, i.e.~1 + log slicing condition and Gamma-driver shift equations, are dicussed in details in Sec.~\ref{gauge}. They are then modified to covariant forms and a guideline of how to implement this covariant gauge condition is provided. Last but not least, in Sec.~\ref{example} we demonstrate how this scheme works in a specific coordinate transformation case, time dependent spatial rotation.
\section{3 + 1 Splitting}\label{3+1}
Throughout this paper, we use Greek letter indices $\mu$, $\nu$, ... to denote spacetime indices and Latin letters $a$, $b$, ... to denote spatial indices. $\nabla_{\mu}$ stands for the spacetime covariant derivative while $D_{a}$ is the spatial covariant derivative.

In 3 + 1 formulation, we have
\begin{equation*}
^{(4)}g_{\mu\nu} = \begin{pmatrix}-\alpha^2 + \beta^{c}\beta_{c} & \beta_{b}\\\\\beta_{a} & g_{ab}\end{pmatrix}
\end{equation*}
where $\alpha$ is called the lapse function, $\beta^{a}$ the shift vector and $g_{ab}$ the spatial metric. The covariant normal to each foliation is denoted as
\begin{equation}\label{normal covector}
n_{\mu} = -\alpha\delta^{0}_{\mu}
\end{equation}
 And its dual is
\begin{equation}\label{normal vector}
n^{\mu} = (\delta^{\mu}_{0} - \beta^{c}\delta^{\mu}_{c})/\alpha
\end{equation}
so that we have $n_{\mu}n^{\mu} = 1$. 

There is also the projection operator
\begin{equation}\label{projection 1}
X^{\mu}_{a} = \delta^{\mu}_{a}
\end{equation}
that projects a spacetime covector into a spacelike covector. Its covariant form is
\begin{equation}\label{projection 2}
X^{a}_{\mu} = \delta^{a}_{\mu} + \beta^{a}\delta^{0}_{\mu}
\end{equation}
so that we have $X^{\mu}_{a}X^{b}_{\mu} = \delta^{b}_{a}$ and $X^{\mu}_{a}n_{\mu} = 0$. 

With these definitions, the spacetime metric can be written in terms of the spatial metric, the normal and the projection operator as
\begin{equation}\label{spacetime metric 3 + 1}
^{(4)}g_{\mu\nu} = g_{ab}X^{a}_{\mu}X^{b}_{\nu} - n_{\mu}n_{\nu}
\end{equation}
Spacetime indices $\mu$, $\nu$, ... are always raised and lowered with the spacetime metric $^{(4)}g_{\mu\nu}$ and its inverse $^{(4)}g^{\mu\nu}$, while spatial indices $a$, $b$, ... are always raised and lowered with the spatial metric $g_{ab}$ and its inverse $g^{ab}$. 

Another important quantity in 3 + 1 splitting, the extrinsic curvature is defined as
\begin{equation}\label{extrinsic}
K_{ab} = - \frac{1}{2\alpha}\left[\partial_{t}g_{ab} - 2D_{(a}\beta_{b)}\right]
\end{equation}
\section{Foliation Preserving Coordinate Transformation}\label{transform}
{\bf {\color{red}PROPERTY OF THIS TRANSFORMATION.

WHY WE ARE FOCUS ON THIS TRANSFORMATION.}} 

This foliation preserving coordinate transformation is a time dependent spatial diffeomorphism combined with time reparameterization. We use $x^{\mu}$ to denote the original coordinate basis and $x^{\mu'}$ the transformed coordinate basis. Therefore, the transformation can be described as
\begin{align*}
t' & = t'(t)\\
x^{a'} & = x^{a'}(t,x^{a})
\end{align*}
and vice versa, we have
\begin{align*}
t & = t(t')\\
x^{a} & = x^{a}(t',x^{a'})
\end{align*}
Use the chain rule of partial differentiation to inspect the delta function for this tranformation, we have
\[
\delta^{a}_{b} = \frac{\partial x^{a}}{\partial x^{b}} = \frac{\partial x^{a}}{\partial x^{\mu'}}\frac{\partial x^{\mu'}}{\partial x^{b}} = \frac{\partial x^{a}}{\partial t'}\frac{\partial t'}{\partial x^{b}} + \frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{a'}}{\partial x^{b}}
\]
and since $t' = t'(t)$, $\partial t'/\partial x^{b} = 0$, hence we reached an important identity of this coordinate transformation
\begin{equation}
\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{a'}}{\partial x^{b}} = \delta^{a}_{b}
\end{equation}
and equivalently
\begin{equation}
\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{a}}{\partial x^{b'}} = \delta^{a'}_{b'}
\end{equation}
The spacetime metric transforms regularly under this transformation
\begin{align}\label{spacetime metric}
^{(4)}g_{\mu'\nu'} &=~^{(4)}g_{\mu\nu}\frac{\partial x^{\mu}}{\partial x^{\mu'}}\frac{\partial x^{\nu}}{\partial x^{\nu'}}\notag\\
& = (g_{ab}X^{a}_{\mu}X^{b}_{\nu} - n_{\mu}n_{\nu})\frac{\partial x^{\mu}}{\partial x^{\mu'}}\frac{\partial x^{\nu}}{\partial x^{\nu'}}
\end{align}
By substituting the indices $\mu'$ and $\nu'$ for $a'$ and $b'$ respectively in Eq.~\ref{spacetime metric}, we can obtain the transformation law of the spatial metric
\begin{align}
g_{a'b'} & = (g_{ab}X^{a}_{\mu}X^{b}_{\nu} - n_{\mu}n_{\nu})\frac{\partial x^{\mu}}{\partial x^{a'}}\frac{\partial x^{\nu}}{\partial x^{b'}}\notag\\
&= g_{ab}(\frac{\partial x^{a}}{\partial x^{a'}} + \beta^{a}\frac{\partial t}{\partial x^{a'}})(\frac{\partial x^{b}}{\partial x^{b'}} + \beta^{b}\frac{\partial t}{\partial x^{b'}}) - \alpha^2\frac{\partial t}{\partial x^{a'}}\frac{\partial t}{\partial x^{b'}}\notag\\
& = g_{ab}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}
\end{align}
And its inverse transforms as
\begin{equation}
g^{a'b'} = g^{ab}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{b'}}{\partial x^{b}}\label{spatial metric}
\end{equation}
Let $g$ denote the determinant of the spatial metric $g_{ab}$. It transforms as
\begin{equation}
g' = |g_{a'b'}| = |g_{ab}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}| = |g_{ab}||\frac{\partial x^{a}}{\partial x^{a'}}||\frac{\partial x^{b}}{\partial x^{b'}}| = g|\frac{\partial x}{\partial x'}|^{2}
\end{equation}
where $|\partial x/\partial x'|$ stands for the Jacobian matrix determinant of this coordinate transformation. 


Besides from the spatial metric, the lapse $\alpha$ and the shift vector $\beta^{a}$ are two significant variables in the 3 + 1 splitting scheme. 

From equations [\ref{normal covector}-\ref{spacetime metric 3 + 1}], we have that
\begin{align}
^{(4)}g_{a0} & = \beta_{a}\label{lapse}\\
^{(4)}g_{00} & = -\alpha^2 + g_{ab}\beta^{a}\beta^{b}\label{shift}
\end{align}
According to Eq.~\ref{lapse} and Eq.~\ref{spacetime metric}, we have
\begin{align}
\beta_{a'} & = (g_{ab}X^{a}_{\mu}X^{b}_{\nu} - n_{\mu}n_{\nu})\frac{\partial x^{\mu}}{\partial x^{a'}}\frac{\partial x^{\nu}}{\partial t'}\notag\\
& = g_{ab}X^{a}_{\mu}X^{b}_{\nu}\delta_{c}^{\mu}\frac{\partial x^{c}}{\partial x^{a'}}\frac{\partial x^{\nu}}{\partial t'}\notag\\
& = g_{ab}(\delta^{b}_{\nu} + \beta^{b}\delta^{0}_{\nu})\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{\nu}}{\partial t'}\notag\\
& = \beta_{a}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial t}{\partial t'} + g_{ab}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial t'}\label{shift covector transform}
\end{align}
Use the results from Eq.~\ref{spatial metric} and Eq.~\ref{shift covector transform}, we can easily derive the transform law of the shift vector
\begin{align}
\beta^{a'} & = \beta_{b'}g^{a'b'}\notag\\
& = \left(\beta_{b}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial t}{\partial t'} + g_{cd}\frac{\partial x^{d}}{\partial x^{b'}}\frac{\partial x^{c}}{\partial t'}\right)g^{ab}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{b'}}{\partial x^{b}}\notag\\
& = \beta^{a}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'} + \frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{a}}{\partial t'}\label{shift vector transform}
\end{align}
Use the result from Eq.~\ref{shift vector transform} along with Eq.~\ref{lapse} and Eq.~\ref{spacetime metric}, we can derive the transform law of the lapse function. 
\begin{align*}
\alpha'^{2} & = - (g_{ab}X^{a}_{\mu}X^{b}_{\nu} - n_{\mu}n_{\nu})\frac{\partial x^{\mu}}{\partial t'}\frac{\partial x^{\nu}}{\partial t'} + g_{a'b'}\beta^{a'}\beta^{b'}\notag\\ 
& = \alpha^2\left(\frac{\partial t}{\partial t'}\right)^{2}
\end{align*}
Therefore we have
\begin{equation}
\alpha' = \alpha\frac{\partial t}{\partial t'}\label{lapse transform}
\end{equation}
From the calculation above we can tell that the shift vector $\beta^{a}$ doesn't transform as a vector under this coordinate transformation. In order to resolve this, we introduce the backgrond metric denoted as ${\bar g}_{\mu\nu}$. The background metric was initially introduced to make the Christoffel symbols transform as a tensor and it is usually defined as a trivial metric, i.e., ${\bar g}_{\mu\nu} = diag(-1,1,1,1)$. Therefore, we have ${\bar g} = -1, $${\bar \Gamma}^{a}_{~bc} = 0$, ${\bar \alpha} = 1$ and ${\bar \beta}^{a} = 0$. The background shift vector ${\bar \beta}^{a}$ follows the same transform law of $\beta^{a}$
\[
{\bar \beta}^{a'} = {\bar \beta}^{a}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'} + \frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{a}}{\partial t'}
\]
and hence the difference between $\beta^{a}$ and ${\bar \beta}^{a}$ transform as a vector
\begin{equation}
\Delta \beta^{a'} = \Delta \beta^{a}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'}
\end{equation}
where $\Delta \beta^{a} = \beta^{a} - {\bar \beta}^{a}$.
 
Now we have investigated the transform law of the terms without any derivatives. However, since the 1 + log slicing condition and Gamma-driver shift equation are both first order partial differentiation equations, we still need to learn how partial derivative terms transform under the foliation preserving coordinate transformation. 

In order to study how partial derivatives transform, let's review the chain rule for this diffeomorphism briefly. The chain rule in spacetime domain states as below
\begin{equation*}
\partial_{\mu'} = \frac{\partial x^{\mu}}{\partial x^{\mu'}}\partial_{\mu}
\end{equation*}
Therefore, if $\mu' = t'$, we have that
\begin{equation}\label{time derivative}
\partial_{t'} = \frac{\partial x^{c}}{\partial t'}\partial_{c} + \frac{\partial t}{\partial t'}\partial_{t}
\end{equation}
and if $\mu' = a'$, since $\partial t/\partial x^{a'} = 0$, we have
\begin{equation}\label{spatial derivative}
\partial_{a'} = \frac{\partial x^{c}}{\partial x^{a'}}\partial_{c}
\end{equation}
From Eq.~\ref{time derivative} and Eq.~\ref{spatial derivative} we can tell that the spatial derivative transforms just like tensor without introducing any extra terms. On the other hand, in the time derivative transformations, there are one extra term $(\partial t/\partial t')\partial_{t}$ involved, since $\partial t/\partial t' \ne 0$. According to this analysis, the spatial Christoffel symbol transforms as the spacetime Christoffel symbol, since it is only constructed by the spatial metric and its spatial derivatives. 
\begin{equation}
\Gamma^{a'}_{~b'c'} = \Gamma^{a}_{~bc}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial x^{c}}{\partial x^{c'}} + \frac{\partial x^{a'}}{\partial x^{d}}\frac{\partial^{2} x^{d}}{\partial x^{b'}\partial x^{c'}}
\end{equation}
In addition, the tensorial form of Christoffel symbol is $\Delta \Gamma^{a}_{~bc} \equiv \Gamma^{a}_{~bc} - {\bar \Gamma}^{a}_{~bc}$ and
\begin{equation}
\Delta \Gamma^{a'}_{~b'c'} = \Delta \Gamma^{a}_{~bc}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial x^{c}}{\partial x^{c'}}
\end{equation}
Furthermore, the spatial covariant derivative of a tensor also transforms as a tensor. Specifically, the spatial covariant derivative of the shift covector transforms as
\begin{align}
D_{a'}\beta_{b'} &= D_{a'}\left(\beta^{b}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial t}{\partial t'}\right) + D_{a'}\left(g_{bc}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial x^{c}}{\partial t'}\right)\notag\\
& = \frac{\partial t}{\partial t'}D_{a'}\left(\beta_{b}\frac{\partial x^{b}}{\partial x^{b'}}\right) + D_{a'}\left(g_{b'c'}\frac{\partial x^{c'}}{\partial x^{c}}\frac{\partial x^{c}}{\partial t'}\right)\notag\\
& = D_{a}\beta^{b}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial t}{\partial t'} + g_{b'c'}D_{a'}\left(\frac{\partial x^{c'}}{\partial x^{c}}\frac{\partial x^{c}}{\partial t'}\right)
\end{align} 
Now let's examine the time derivative of the spatial metric
\begin{align}
\partial_{t'}g_{a'b'} & = (\partial_{t'}g_{ab})\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}} + g_{ab}\partial_{t'}\left(\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}\right)\notag\\
& =  (\partial_{t}g_{ab})\frac{\partial t}{\partial t'}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}} + (\partial_{c}g_{ab})\frac{\partial x^{c}}{\partial t'}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}} + g_{ab}\partial_{t'}\left(\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}\right)
\end{align}
As a result, the extrinsic curvature transforms as a (0,2) tensor, we omitted the tedious calculation and list the result below
\begin{align}
K_{a'b'} & = -\frac{1}{2\alpha'}\left(\partial_{t'}g_{a'b'} - D_{a'}\beta_{b'} - D_{b'}\beta_{a'}\right)\notag\\
& = K_{ab}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}
\end{align}
The spatial partial derivative of $\alpha$, which appears in the advection term of the 1 + log slicing equation, transforms as 
\begin{align}
\partial_{a'}\alpha' & = \frac{\partial x^{c}}{\partial x^{a'}}\partial_{c}\left(\alpha \frac{\partial t}{\partial t'}\right)\\
& = \frac{\partial t}{\partial t'}\frac{\partial x^{c}}{\partial x^{a'}}\partial_{c}\alpha
\end{align}
Due to the extra term introduced by time derivative transformation, the time derivative of $\alpha$ raises a more interesting case, 
\begin{align}
\partial_{t'}\alpha' & = \partial_{t'}\left(\alpha\frac{\partial t}{\partial t'}\right)\notag\\
& = \frac{\partial t}{\partial t'}\partial_{t'}\alpha + \alpha\frac{\partial^{2}t}{\partial {t'}^{2}}\notag\\
& = \partial_{t}\alpha\left(\frac{\partial t}{\partial t'}\right)^{2} + \partial_{c}\alpha\frac{\partial x^{c}}{\partial t'}\frac{\partial t}{\partial t'} + \alpha\frac{\partial^{2}t}{\partial {t'}^{2}}
\end{align}
In order to construct an invariant form of the time derivative of the lapse function $\mathscr{D}_{t}\alpha$ such that
\[
\mathscr{D}_{t'}\alpha' = \mathscr{D}_{t}\alpha\left(\frac{\partial t}{\partial t'}\right)^{2}
\]
we define $\mathscr{D}_{t}\alpha$ as
\begin{equation}
\mathscr{D}_{t}\alpha = \partial_{t}\alpha - \beta^{c}\partial_{c}\alpha - \frac{\alpha}{{\bar \alpha}}(\partial_{t}{\bar \alpha} - {\bar \beta}^{c}\partial_{c}{\bar \alpha})
\end{equation}
and check how it transforms
\begin{align}
\mathscr{D}_{t'}\alpha' & = \partial_{t'}\alpha' - \beta^{c'}\partial_{c'}\alpha' - \frac{\alpha'}{{\bar \alpha}'}(\partial_{t'}{\bar \alpha}' - {\bar \beta}^{c'}\partial_{c'}{\bar \alpha}')\notag\\
& = \partial_{t}\alpha\left(\frac{\partial t}{\partial t'}\right)^{2} + \partial_{c}\alpha\frac{\partial x^{c}}{\partial t'}\frac{\partial t}{\partial t'} + \alpha\frac{\partial^{2}t}{\partial {t'}^{2}} - \left(\beta^{c}\frac{\partial x^{c'}}{\partial x^{c}}\frac{\partial t}{\partial t'} + \frac{\partial x^{c'}}{\partial x^{c}}\frac{\partial x^{c}}{\partial t'}\right)\frac{\partial t}{\partial t'}\frac{\partial x^{d}}{\partial x^{c'}}\partial_{d}\alpha\notag\\
& - \frac{\alpha}{{\bar \alpha}}\left[\partial_{t}{\bar \alpha}\left(\frac{\partial t}{\partial t'}\right)^{2} + \partial_{c}{\bar \alpha}\frac{\partial x^{c}}{\partial t'}\frac{\partial t}{\partial t'} + {\bar \alpha}\frac{\partial^{2}t}{\partial {t'}^{2}} - \left({\bar\beta}^{c}\frac{\partial x^{c'}}{\partial x^{c}}\frac{\partial t}{\partial t'} + \frac{\partial x^{c'}}{\partial x^{c}}\frac{\partial x^{c}}{\partial t'}\right)\frac{\partial t}{\partial t'}\frac{\partial x^{d}}{\partial x^{c'}}\partial_{d}{\bar\alpha}\right]\notag\\
& = \mathscr{D}_{t}\alpha\left(\frac{\partial t}{\partial t'}\right)^{2}
\end{align}
For formulating the invariant form of the shift vector's time derivative, $\partial_{t}\Delta \beta^{a}$ would b
e a suitable candidate, since $\Delta \beta^{a}$ itself transforms as a tensor density already. Let's try to transform $\partial_{t} \Delta \beta^{a}$
\begin{align}\label{time derivative delta beta} 
\partial_{t'}\Delta \beta^{a'} & = \left(\partial_{t'}\Delta \beta^{a}\right)\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'} + \Delta \beta^{a}\partial_{t'}\left(\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'}\right)\notag\\
& = \partial_{t}\Delta \beta^{a}\frac{\partial x^{a'}}{\partial x^{a}}\left(\frac{\partial t}{\partial t'}\right)^{2} + \partial_{c}\Delta \beta^{a}\frac{\partial x^{c}}{\partial t'}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'}\notag\\
& + \Delta \beta^{a}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial^{2}t}{\partial t'^{2}} + \Delta \beta^{a}\frac{\partial^{2} x^{a'}}{\partial x^{c}\partial x^{a}}\frac{\partial x^{c}}{\partial t'}\frac{\partial t}{\partial t'} + \Delta \beta^{a}\frac{\partial^{2}x^{a'}}{\partial t\partial x^{a}}\left(\frac{\partial t}{\partial t'}\right)^{2}
\end{align}
As we expected, there are several extra terms in Eq.~\ref{time derivative delta beta} prevent $\partial_{t}\Delta\beta^{a}$ from being a tensor density. 

By observing the transform laws of $\partial_{t}\Delta\beta^{a}$, $\beta^{a}$, $D_{a}\beta_{b}$ and $\partial_{a}\alpha$, we propose an ansatz of $\mathscr{D}_{t}\beta^{a}$ such that $\mathscr{D}_{t}\beta^{a}$ transforms as a tensor density, where $\mathscr{D}_{t}\beta^{a}$ is defined as
\begin{equation}
\mathscr{D}_{t}\beta^{a} = \partial_{t}\Delta \beta^{a} - \frac{\Delta \beta^{a}}{{\bar \alpha}}(\partial_{t}{\bar \alpha} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}) + c_{1}\beta^{b}{\bar D}_{b}\beta^{a} + c_{2}\beta^{b}{\bar D}_{b}{\bar \beta}^{a} + c_{3}{\bar \beta}^{b}{\bar D}_{b}\beta^{a} + c_{4}{\bar \beta}^{b}{\bar D}_{b}{\bar \beta}^{a}
\end{equation}
and $c_{1}$, $c_{2}$, $c_{3}$ and $c_{4}$ are all constants. 

Determining the values of these constants involves tedious calculation, so we skip to the conclusion here. The constants obey the following constraints
\begin{align*}
c_{1} + c_{3} & = -1\\
c_{2} + c_{4} & = 1\\
c_{1} + c_{2} & = 1\\
c_{3} + c_{4} & = -1 
\end{align*}
so that $\mathscr{D}_{t} \beta^{a}$ transforms as a tensor density. 

Therefore, we define $\sigma \equiv c_{1}$ and write the rest of those constants in terms of $\sigma$ to get the final formulation of $\mathscr{D}_{t}\beta^{a}$ as below
\begin{equation}
\mathscr{D}_{t}\beta^{a} = \partial_{t}\Delta \beta^{a} - \frac{\Delta \beta^{a}}{{\bar \alpha}}(\partial_{t}{\bar \alpha} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}) + \sigma\beta^{b}{\bar D}_{b}\beta^{a} + (1-\sigma)\beta^{b}{\bar D}_{b}{\bar \beta}^{a} - (1 + \sigma){\bar \beta}^{b}{\bar D}_{b}\beta^{a} + \sigma{\bar \beta}^{b}{\bar D}_{b}{\bar \beta}^{a}
\end{equation}
and we have
\begin{equation}
\mathscr{D}_{t'}\beta^{a'} = \mathscr{D}_{t}\beta^{a}\frac{\partial x^{a'}}{\partial x^{a}}\left(\frac{\partial t}{\partial t'}\right)^{2}
\end{equation}
\section{}\label{gauge}
We studied the transform law of all the important variables in 3 + 1 splitting mechanism under the foliation preserving coordinate transformation in Sec.~\ref{transform}, now we will use these results to construct the invariant form of the 1 + log slicing condition and Gamma-driver shift equation. 

The regular 1 + log slicing condition reads as
\begin{equation}
\partial_{t}\alpha - \beta^{c}\partial_{c}\alpha = -2\alpha K
\end{equation}
After the analysis in Sec.~\ref{transform}, one can notice that neither the right hand side nor the left hand side transforms tensorially. We start by replacing the left hand side by $\mathscr{D}_{t}\alpha$. Since $\mathscr{D}_{t'}\alpha' = \mathscr{D}_{t}\alpha(\partial t/\partial t')^{2}$, in order to balance the right hand side, we modify it to be $-2\alpha {\bar \alpha}K$. After this modification, we have
\begin{align*}
\mathscr{D}_{t'}\alpha' & = \mathscr{D}_{t}\alpha\left(\frac{\partial t}{\partial t'}\right)^{2}\\
& = -2\alpha{\bar \alpha}K\left(\frac{\partial t}{\partial t'}\right)^{2}\\
& = -2\left(\alpha\frac{\partial t}{\partial t'}\right)\left({\bar \alpha}\frac{\partial t}{\partial t'}\right)K\\
& = -2\alpha'{\bar \alpha}'K'
\end{align*}
Therefore, we have reached the invariant form of 1 + log slicing condition as below
\begin{equation}\label{invariant 1 + log slicing}
\mathscr{D}_{t}\alpha = -2\alpha{\bar \alpha}K
\end{equation}

We can follow the same strategy to alter the Gamma-driver shift equation, replacing the left hand side by $\mathscr{D}_{t}\beta^{a}$ and setting $\sigma$ to be -1, changing every non-tensorial term on the right hand side to its corresponding tensorial term and balance the transform factor on both sides. Therefore, the regular Gamma-driver shift equation
\begin{equation}
{\dot \beta}^{a} - \beta^{b}\partial_{b}\beta^{a} = \frac{3}{4}\sqrt{g}^{2/3}(\Gamma^{a}_{~bc}g^{bc} + \frac{1}{3}g^{ab}\Gamma^{c}_{~bc}) - \eta \beta^{a} 
\end{equation}
becomes
\begin{equation}\label{invariant Gamma-driver shift}
\mathscr{D}_{t}\beta^{a} = \frac{3}{4}\sqrt{\frac{g}{{\bar g}}}^{2/3}{\bar \alpha}^{2}(\Delta \Gamma^{a}_{~bc}g^{bc} + \frac{1}{3}g^{ab}\Delta\Gamma^{c}_{~bc}) - \eta {\bar \alpha}\Delta\beta^{a}
\end{equation}
Writing down these invariant gauge conditions creates more possibilities for numerical simulation. When the need of evolving the system in a different coordinates system rises, one can just use the following equations as gauge conditions
\begin{align*}
\mathscr{D}_{t'}\alpha' & = -2\alpha'{\bar \alpha}'K'\\
\mathscr{D}_{t'}\beta^{a'} & = \frac{3}{4}\sqrt{\frac{g'}{{\bar g}'}}^{2/3}{\bar \alpha}'^{2}(\Delta \Gamma^{a'}_{~b'c'}g^{b'c'} + \frac{1}{3}g^{a'b'}\Delta\Gamma^{c'}_{~b'c'}) - \eta {\bar \alpha}'\Delta\beta^{a'}
\end{align*}
while the transformed background metric terms are associated with the original terms as below
\begin{align}
{\bar g}_{a'b'} & = {\bar g}_{ab}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b}}{\partial x^{b'}}\\
{\bar g'} & = {\bar g}|\frac{\partial x}{\partial x'}|^{2}\\
{\bar \alpha}' & = {\bar \alpha}\frac{\partial t}{\partial t'}\\
{\bar \beta}^{a'} & = {\bar \beta}^{a}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial t}{\partial t'} + \frac{\partial x^{a'}}{\partial x^{c}}\frac{\partial x^{c}}{\partial t'}\label{background shift}\\
{\bar \Gamma}^{a'}_{~b'c'} & = {\bar \Gamma}^{a}_{~bc}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{b}}{\partial x^{b'}}\frac{\partial x^{c}}{\partial x^{c'}} + \frac{\partial x^{a'}}{\partial x^{d}}\frac{\partial x^{d}}{\partial x^{b'}\partial x^{c'}}
\end{align}
We will explain how this scheme works in detail with a specific example in the next section. 
\section{Time Dependent Spatial Rotation Coordinate Transformation}\label{example}
In this section, we examine a specific kind of coordinate transformation, the time dependent spatial rotation coordinate transformation, and demonstrate how the invariant gauge conditions work in action. 

In this coordinate transformation, we keep the $t$ coordinate intact while let the spatial coordinate rotates around the $z$ axis at a constant angular speed $\omega$. Hence the transformed coordinates can be expressed in terms of the original terms as below
\begin{align}
t' & = t\notag\\
x' & = x \cos(\omega t) + y\sin(\omega t)\notag\\
y' & = -x\sin(\omega t) + y\cos(\omega t)\notag\\
z' & = z
\end{align}
and equivalently, 
\begin{align}
t & = t'\notag\\
x & = x'\cos(\omega t') - y'\sin(\omega t')\notag\\
y & = x'\sin(\omega t') + y'\cos(\omega t')\notag\\
z & = z'
\end{align}
We also assume that the background metric is trivial
\begin{align}
{\bar g}_{ab} & = diag(1,1,1)\notag\\
{\bar \alpha} & = 1\notag\\
{\bar \beta} & = 0 
\end{align}
Under this transformation, we have $\partial t/\partial t' = 1$, therefore ${\bar \alpha}' = {\bar \alpha}$ and hence the invariant time derivative of $\alpha$ will collapse to
\begin{equation}
\mathscr{D}_{t}\alpha = \partial_{t}\alpha - \beta^{a}\partial_{a}\alpha
\end{equation}
Then the invariant 1 + log slicing condition under this transformation becomes
\begin{equation}\label{transformed 1 + log slicing}
\partial_{t'}\alpha' - \beta^{a'}\partial_{a'}\alpha' = -2\alpha'K'
\end{equation}
One would argue that this equation is identical to the regular 1 + log slicing equation. This is only true under this specific coordinate transformation, especially when we have $\partial t/\partial t' = 1$. One will see the difference in the Gamma-driver shift equation discussed below. 

According to Eq.~\ref{background shift} and the choice that ${\bar \beta}^{a} = 0$, we have that
\[
{\bar \beta}^{a'} = \frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{a}}{\partial t'}
\]
Therefore, for each component, we have
\begin{align*}
{\bar \beta}^{1'} & = -\omega y'\\
{\bar \beta}^{2'} & = \omega x'\\
{\bar \beta}^{3'} & = 0
\end{align*}
Similarly, for the background Christoffel symbol, we have
\[
{\bar \Gamma}^{a'}_{b'c'} = \frac{\partial x^{a'}}{\partial x^{d}}\frac{\partial x^{d}}{\partial x^{b'}\partial x^{c'}}
\]
however, since in this coordinate transformation, $x^{a}$ is a first order function of $x^{a'}$, ${\bar \Gamma}^{a'}_{b'c'}$ vanishes. 

Also, it is easy to check that $|\partial x/\partial x'| = 1$, this result yields that $g' = g = 1$. According to these results above, the transformed Gamma-driver Shift equation becomes
\begin{equation}
\partial_{t'}\beta^{a'} - \beta^{b'}\partial_{b'}\beta^{a'} + 2\beta^{b'}\partial_{b'}{\bar \beta}^{a'} - {\bar \beta}^{b'}\partial_{b'}{\bar \beta}^{a'} = \frac{3}{4}\sqrt{g'}^{2/3}\left(\Gamma^{a'}_{~b'c'}g^{b'c'} + \frac{1}{3}g^{a'b'}\Gamma^{c'}_{~b'c'}\right) - \eta \Delta \beta^{a'}
\end{equation}
and for each component, we have
\begin{align}
\partial_{t'}\beta^{1'} - \beta^{b'}\partial_{b'}\beta^{1'} - 2\omega\beta^{2'} + \omega^{2}x' &= \frac{3}{4}\sqrt{g'}^{2/3}\left(\Gamma^{1'}_{~b'c'}g^{b'c'} + \frac{1}{3}g^{1'b'}\Gamma^{c'}_{~b'c'}\right) - \eta (\beta^{1'} + \omega y')\label{transformed Gamma-driver shift x}\\
\partial_{t'}\beta^{2'} - \beta^{b'}\partial_{b'}\beta^{2'} + 2\omega\beta^{1'} - \omega^{2}y' &= \frac{3}{4}\sqrt{g'}^{2/3}\left(\Gamma^{2'}_{~b'c'}g^{b'c'} + \frac{1}{3}g^{2'b'}\Gamma^{c'}_{~b'c'}\right) - \eta (\beta^{a'} - \omega x')\label{transformed Gamma-driver shift y}\\
\partial_{t'}\beta^{3'} - \beta^{b'}\partial_{b'}\beta^{3'} & = \frac{3}{4}\sqrt{g'}^{2/3}\left(\Gamma^{3'}_{~b'c'}g^{b'c'} + \frac{1}{3}g^{3'b'}\Gamma^{c'}_{~b'c'}\right) - \eta \beta^{3'}\label{transformed Gamma-driver shift z}
\end{align}
To verify the transformed gauge conditions(Eq.~\ref{transformed 1 + log slicing} and equations [\ref{transformed Gamma-driver shift x}-\ref{transformed Gamma-driver shift y}]) obtained by the invariant gauge conditions, we try to write down the transformed gauge conditions by transforming the variables in the regular gauge conditions explicitly and compare with the equations we already have. 

According to the transform rules we obtained in \ref{transform}, let's write the untransformed variables in terms of the transformed variables. 
\begin{align}
\alpha & = \alpha'\frac{\partial t'}{\partial t} = \alpha\\
\beta^{a} & = \left(\beta^{a'} - \frac{\partial x^{a'}}{\partial x^{b}}\frac{\partial x^{b}}{\partial t'}\right)\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial t'}{\partial t}\\
g_{ab} & = g_{a'b'}\frac{\partial x^{a'}}{\partial x^{a}}\frac{\partial x^{b'}}{\partial x^{b}}\\
\Gamma^{a}_{~bc} & = \left(\Gamma^{a'}_{~b'c'} - \frac{\partial x^{a'}}{\partial x^{d}}\frac{\partial x^{d}}{\partial x^{b'}\partial x^{c'}}\right)\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b'}}{\partial x^{b}}\frac{\partial x^{c'}}{\partial x^{c}} = \Gamma^{a'}_{~b'c'}\frac{\partial x^{a}}{\partial x^{a'}}\frac{\partial x^{b'}}{\partial x^{b}}\frac{\partial x^{c'}}{\partial x^{c}}
\end{align}
Plug these equations into Eq.~\ref{invariant 1 + log slicing} and Eq.~\ref{invariant Gamma-driver shift}, we have
\begin{align}
\partial_{t'}\alpha
\end{align}
\end{document}
